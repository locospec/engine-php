{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://locospec.com/schemas/action.json",
    "title": "Action Spec",
    "description": "Spec for defining a action",
    "type": "object",
    "properties": {
        "name": {
            "type": "string",
            "description": "The unique identifier for the action, following a specific naming convention.",
            "minLength": 1,
            "pattern": "^[a-z]+(?:[-_][a-z]+)*$"
        },
        "label": {
            "type": "string",
            "description": "A human-readable label for the action."
        },
        "type": {
            "type": "string",
            "enum": ["action"],
            "description": "Type identifier for the spec."
        },
        "dbOp": {
            "type": "string",
            "enum": ["insert", "update", "delete"],
            "description": "Type of database operation for the spec."
        },
        "model": {
            "type": "string",
            "description": "The name of the associated model, which must be defined.",
            "minLength": 1,
            "pattern": "^[a-z]+(?:[-_][a-z]+)*$"
        },
        "attributes": {
            "type": "object",
            "description": "Model field definitions",
            "additionalProperties": {
                "type": "object",
                "properties": {
                    "type": {
                        "type": "string",
                        "description": "Field data type",
                        "enum": [
                            "id",
                            "uuid",
                            "ulid",
                            "string",
                            "text",
                            "timestamp",
                            "boolean",
                            "integer",
                            "date",
                            "decimal",
                            "json",
                            "jsonb",
                            "object"
                        ]
                    },
                    "label": {
                        "type": "string",
                        "description": "Label for the attribute"
                    },
                    "generations": {
                        "type": "array",
                        "description": "List of generation rules for the attribute",
                        "items": {
                            "type": "object",
                            "properties": {
                                "type": {
                                    "type": "string",
                                    "description": "Type of generation"
                                },
                                "source": {
                                    "type": "string",
                                    "description": "Source field for generation",
                                    "optional": true
                                },
                                "value": {
                                    "type": "string",
                                    "description": "Value for generation",
                                    "optional": true
                                }
                            },
                            "required": ["type"]
                        }
                    },
                    "validations": {
                        "type": "array",
                        "description": "List of validation rules for the attribute",
                        "items": {
                            "type": "object",
                            "properties": {
                                "type": {
                                    "type": "string",
                                    "description": "Type of validation"
                                },
                                "message": {
                                    "type": "string",
                                    "description": "Validation error message"
                                }
                            },
                            "required": ["type", "message"]
                        }
                    }
                },
                "required": ["type", "label"]
            }
        }
    },
    "required": ["name", "type", "label", "dbOp", "model", "attributes"],
    "additionalProperties": false
}
